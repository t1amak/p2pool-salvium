diff --git a/crypto/internal.h b/crypto/internal.h
index 28d45a4a4..e0c5a6b42 100644
--- a/crypto/internal.h
+++ b/crypto/internal.h
@@ -55,7 +55,7 @@
 #if defined(OPENSSL_WINDOWS_THREADS)
 #include <windows.h>
 #endif
-#if defined(_M_X64) || defined(_M_IX86)
+#if defined(_MSC_VER) && (defined(_M_X64) || defined(_M_IX86))
 #include "intrin.h"
 #endif
 
