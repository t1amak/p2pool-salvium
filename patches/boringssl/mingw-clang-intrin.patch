diff --git a/crypto/internal.h b/crypto/internal.h
index 30ec7df16..6331cae4a 100644
--- a/crypto/internal.h
+++ b/crypto/internal.h
@@ -54,7 +54,7 @@
 #include <windows.h>
 #endif
 
-#if defined(_M_X64) || defined(_M_IX86)
+#if defined(_MSC_VER) && (defined(_M_X64) || defined(_M_IX86))
 #include "intrin.h"
 #endif
 
